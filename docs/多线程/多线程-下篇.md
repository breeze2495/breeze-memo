# å…±äº«æ¨¡å‹ä¹‹å·¥å…·

## âœ¨çº¿ç¨‹æ± 

æ± åŒ–æŠ€æœ¯ç›¸æ¯”å¤§å®¶å·²ç»å±¡è§ä¸é²œäº†ï¼Œçº¿ç¨‹æ± ã€æ•°æ®åº“è¿æ¥æ± ã€Http è¿æ¥æ± ç­‰ç­‰éƒ½æ˜¯å¯¹è¿™ä¸ªæ€æƒ³çš„åº”ç”¨ã€‚**æ± åŒ–æŠ€æœ¯çš„æ€æƒ³ä¸»è¦æ˜¯ä¸ºäº†å‡å°‘æ¯æ¬¡è·å–èµ„æºçš„æ¶ˆè€—ï¼Œæé«˜å¯¹èµ„æºçš„åˆ©ç”¨ç‡**ã€‚
çº¿ç¨‹æ± æä¾›äº†ä¸€ç§é™åˆ¶å’Œç®¡ç†èµ„æºï¼ˆåŒ…æ‹¬æ‰§è¡Œä¸€ä¸ªä»»åŠ¡ï¼‰ã€‚ æ¯ä¸ªçº¿ç¨‹æ± è¿˜ç»´æŠ¤ä¸€äº›åŸºæœ¬ç»Ÿè®¡ä¿¡æ¯ï¼Œä¾‹å¦‚å·²å®Œæˆä»»åŠ¡çš„æ•°é‡ã€‚

è¿™é‡Œå€Ÿç”¨ã€ŠJava å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ã€‹æåˆ°çš„æ¥è¯´ä¸€ä¸‹ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„ï¼š

- é™ä½èµ„æºæ¶ˆè€—ã€‚é€šè¿‡é‡å¤åˆ©ç”¨å·²åˆ›å»ºçš„çº¿ç¨‹é™ä½çº¿ç¨‹åˆ›å»ºå’Œé”€æ¯é€ æˆçš„æ¶ˆè€—ã€‚
- æé«˜å“åº”é€Ÿåº¦ã€‚å½“ä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œä»»åŠ¡å¯ä»¥ä¸éœ€è¦çš„ç­‰åˆ°çº¿ç¨‹åˆ›å»ºå°±èƒ½ç«‹å³æ‰§è¡Œã€‚
- æé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§ã€‚çº¿ç¨‹æ˜¯ç¨€ç¼ºèµ„æºï¼Œå¦‚æœæ— é™åˆ¶çš„åˆ›å»ºï¼Œä¸ä»…ä¼šæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œè¿˜ä¼šé™ä½ç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥è¿›è¡Œç»Ÿä¸€çš„åˆ†é…ï¼Œè°ƒä¼˜å’Œç›‘æ§ã€‚



### D1: è‡ªå®šä¹‰çº¿ç¨‹æ± 

<img src="https://gitee.com/breeze1002/upic/raw/master/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E5%A4%9A%E7%BA%BF%E7%A8%8B/2021%2010%2028%2011%2033%2003%201635391983%201635391983073%20RI4SF3%20image-20210621145552291.png" alt="image-20210621145552291" style="zoom:50%;float:left" />

ä¸Šå›¾å°±æ˜¯ä¸€ä¸ªçº¿ç¨‹æ± çš„å®ç°ï¼Œå…ˆåˆå§‹åŒ–çº¿ç¨‹æ± ã€é˜»å¡é˜Ÿåˆ—å¤§å°ï¼Œç„¶åå¼€å‡ ä¸ªçº¿ç¨‹é€šè¿‡çº¿ç¨‹æ± å¯¹è±¡è°ƒç”¨æ–¹æ³•æ‰§è¡Œä»»åŠ¡ï¼Œçº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹ä¼šæ‰§è¡Œä»»åŠ¡ï¼Œå¦‚æœä»»åŠ¡è¿‡å¤šï¼Œä¼šæ·»åŠ åˆ°é˜»å¡é˜Ÿåˆ—ä¸­ï¼Œæ‰§è¡Œå®Œä»»åŠ¡å†ä»é˜»å¡é˜Ÿåˆ—ä¸­å–å€¼ç»§ç»­æ‰§è¡Œã€‚å½“æ‰§è¡Œçš„çº¿ç¨‹æ•°å¤§äºçº¿ç¨‹æ± å’Œé˜»å¡é˜Ÿåˆ—çš„å¤§å°ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰æ‹’ç»ç­–ç•¥ï¼Œç±»ä¼¼ jdk çº¿ç¨‹æ± é‚£æ ·ã€‚ä»£ç å®ç°å¦‚ä¸‹ï¼š

```java
/**
 * è‡ªå®šä¹‰çº¿ç¨‹æ± 
 */
@Slf4j(topic = "c.Code_01_TestPool")
public class Code_01_ThreadPoolTest {

    public static void main(String[] args) {
        ThreadPool threadPool = new ThreadPool(1, 1000, TimeUnit.MILLISECONDS, 1,
                (queue, task) -> {
                    // 1. é˜»å¡ç­‰å¾…ã€‚
//                    queue.put(task);
                    // 2. å¸¦è¶…æ—¶çš„ç­‰å¾…
//                    queue.offer(task, 500, TimeUnit.MILLISECONDS);
                    // 3. è°ƒç”¨è€…æ”¾å¼ƒ
//                    log.info("æ”¾å¼ƒ {}", task);
                    // 4. è°ƒç”¨è€…æŠ›å‡ºå¼‚å¸¸
//                    throw new RuntimeException("ä»»åŠ¡æ‰§è¡Œå¤±è´¥" + task);
                    // 5. è°ƒç”¨è€…è‡ªå·±æ‰§è¡Œä»»åŠ¡
                    task.run();
                });
        for(int i = 0; i < 4; i++) {
            int j = i;
            threadPool.executor(() ->{
                try {
                    Thread.sleep(1000);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
                log.info("{}", j);
            });
        }
    }

}

@FunctionalInterface // æ‹’ç»ç­–ç•¥
interface RejectPolicy<T> {
    void reject(BlockingQueue<T> queue, T task);
}

// å®ç°çº¿ç¨‹æ± 
@Slf4j(topic = "c.ThreadPool")
class ThreadPool {
    // çº¿ç¨‹é›†åˆ
    private Set<Worker> works = new HashSet<Worker>();
    // ä»»åŠ¡é˜Ÿåˆ—
    private BlockingQueue<Runnable> taskQueue;
    // çº¿ç¨‹æ± çš„æ ¸å¿ƒæ•°
    private int coreSize;
    // è·å–ä»»åŠ¡çš„è¶…æ—¶æ—¶é—´
    private long timeout;
    private TimeUnit unit;
    // ä½¿ç”¨ç­–ç•¥æ¨¡å¼ã€‚
    private RejectPolicy<Runnable> rejectPolicy;

    public ThreadPool(int coreSize, long timeout, TimeUnit unit, int queueCapacity,
                      RejectPolicy<Runnable> rejectPolicy) {
        this.coreSize = coreSize;
        this.timeout = timeout;
        this.unit = unit;
        taskQueue = new BlockingQueue<>(queueCapacity);
        this.rejectPolicy = rejectPolicy;
    }

    // æ‰§è¡Œä»»åŠ¡
    public void executor(Runnable task) {
        // å¦‚æœçº¿ç¨‹æ± æ»¡äº†. å°±å°†ä»»åŠ¡åŠ å…¥åˆ°ä»»åŠ¡é˜Ÿåˆ—, å¦åˆ™æ‰§è¡Œä»»åŠ¡
        synchronized (works) {
            if(works.size() < coreSize) {
                Worker worker = new Worker(task);
                log.info("æ–°å¢ worker {} ï¼Œä»»åŠ¡ {}", worker, task);
                works.add(worker);
                worker.start();
            } else {
//                taskQueue.put(task);
                // 1ï¼‰æ­»ç­‰
                // 2ï¼‰å¸¦è¶…æ—¶ç­‰å¾…
                // 3ï¼‰è®©è°ƒç”¨è€…æ”¾å¼ƒä»»åŠ¡æ‰§è¡Œ
                // 4ï¼‰è®©è°ƒç”¨è€…æŠ›å‡ºå¼‚å¸¸
                // 5ï¼‰è®©è°ƒç”¨è€…è‡ªå·±æ‰§è¡Œä»»åŠ¡

                taskQueue.tryPut(rejectPolicy, task);
            }
        }
    }

    class Worker extends Thread {

        private Runnable task;

        public Worker(Runnable task) {
            this.task = task;
        }

        // æ‰§è¡Œä»»åŠ¡
        // 1ï¼‰å½“ task ä¸ä¸ºç©ºï¼Œæ‰§è¡Œä»»åŠ¡
        // 2ï¼‰å½“ task æ‰§è¡Œå®Œæ¯•ï¼Œå†æ¥ç€ä»ä»»åŠ¡é˜Ÿåˆ—è·å–ä»»åŠ¡å¹¶æ‰§è¡Œ
        @Override
        public void run() {
//            while (task != null || (task = taskQueue.take()) != null) {
            while (task != null || (task = taskQueue.poll(timeout, unit)) != null) {
                 try { 
                     log.info("æ­£åœ¨æ‰§è¡Œ {}", task);
                     task.run();
                 }catch (Exception e) {

                 } finally {
                     task = null;
                 }
            }
            synchronized (works) {
                log.info("worker è¢«ç§»é™¤ {}", this);
                works.remove(this);
            }
        }
    }
}
// å®ç°é˜»å¡é˜Ÿåˆ—
@Slf4j(topic = "c.BlockingQueue")
class BlockingQueue<T> {

    // é˜»å¡é˜Ÿåˆ—çš„å®¹é‡
    private int capacity;
    // åŒç«¯é“¾è¡¨, ä»å¤´å–, ä»å°¾åŠ 
    private Deque<T> queue;
    // å®šä¹‰é”
    private ReentrantLock lock;
    // å½“é˜»å¡é˜Ÿåˆ—æ»¡äº†æ—¶å€™, å» fullWaitSet ä¼‘æ¯, ç”Ÿäº§è€…æ¡ä»¶å˜é‡
    private Condition fullWaitSet;
    // å½“é˜»å¡é˜Ÿåˆ—ç©ºäº†æ—¶å€™ï¼Œå» emptyWaitSet ä¼‘æ¯, æ¶ˆè´¹è€…å°ä»¶å˜é‡
    private Condition emptyWaitSet;

    public BlockingQueue(int capacity) {
        queue = new ArrayDeque<>(capacity);
        lock = new ReentrantLock();
        fullWaitSet = lock.newCondition();
        emptyWaitSet = lock.newCondition();
        this.capacity = capacity;
    }

    // å¸¦æœ‰è¶…æ—¶æ—¶é—´çš„è·å–
    public T poll(long timeout, TimeUnit unit) {
        lock.lock();
        try {
            // åŒä¸€æ—¶é—´å•ä½
            long nanos = unit.toNanos(timeout);
            while (queue.isEmpty()) {
                try {
                    if(nanos <= 0) {
                        return null;
                    }
                    // é˜²æ­¢è™šå‡å”¤é†’, è¿”å›çš„æ˜¯æ‰€å‰©æ—¶é—´
                    nanos = emptyWaitSet.awaitNanos(nanos);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }
            T t = queue.removeFirst();
            fullWaitSet.signal();
            return t;
        }finally {
            lock.unlock();
        }
    }

    // è·å–
    public T take() {
        lock.lock();
        try {
            while (queue.isEmpty()) {
                try {
                    emptyWaitSet.await();
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }
            T t = queue.removeFirst();
            fullWaitSet.signal();
            return t;
        }finally {
            lock.unlock();
        }
    }

    // æ·»åŠ 
    public void put(T task) {
        lock.lock();
        try {
            while (queue.size() == capacity) {
                try {
                    log.info("ç­‰å¾…åŠ å…¥ä»»åŠ¡é˜Ÿåˆ— {}", task);
                    fullWaitSet.await();
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }
            log.info("åŠ å…¥ä»»åŠ¡é˜Ÿåˆ— {}", task);
            queue.addLast(task);
            emptyWaitSet.signal();
        }finally {
            lock.unlock();
        }
    }
    // å¸¦æœ‰è¶…æ—¶æ—¶é—´çš„æ·»åŠ 
    public boolean offer(T task, long timeout, TimeUnit unit) {
        lock.lock();
        try {
            long nanos = unit.toNanos(timeout);
            while (queue.size() == capacity) {
                try {
                    if(nanos <= 0) {
                        return false;
                    }
                    log.info("ç­‰å¾…åŠ å…¥ä»»åŠ¡é˜Ÿåˆ— {}", task);
                    nanos = fullWaitSet.awaitNanos(nanos);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }
            log.info("åŠ å…¥ä»»åŠ¡é˜Ÿåˆ— {}", task);
            queue.addLast(task);
            emptyWaitSet.signal();
            return true;
        }finally {
            lock.unlock();
        }
    }

    public void tryPut(RejectPolicy<T> rejectPolicy, T task) {
        lock.lock();
        try {
            // åˆ¤æ–­åˆ¤æ–­æ˜¯å¦æ»¡
            if(queue.size() == capacity) {
                rejectPolicy.reject(this, task);
            } else { // æœ‰ç©ºé—²
                log.info("åŠ å…¥ä»»åŠ¡é˜Ÿåˆ— {}", task);
                queue.addLast(task);
                emptyWaitSet.signal();
            }

        }finally {
            lock.unlock();
        }
    }

    public int getSize() {
        lock.lock();
        try {
            return queue.size();
        } finally {
            lock.unlock();
        }
    }
}
```





### D2: TreadPoolExecutor

#### P1: çº¿ç¨‹æ± çŠ¶æ€

ThreadPoolExecutor ä½¿ç”¨ int çš„é«˜ 3 ä½æ¥è¡¨ç¤ºçº¿ç¨‹æ± çŠ¶æ€ï¼Œä½ 29 ä½è¡¨ç¤ºçº¿ç¨‹æ•°é‡ï¼ŒThreadPoolExecutor ç±»ä¸­çš„çº¿ç¨‹çŠ¶æ€å˜é‡å¦‚ä¸‹ï¼š

> // Integer.SIZE å€¼ä¸º 32 
> private static final int COUNT_BITS = Integer.SIZE - 3;
>
> // runState is stored in the high-order bits
> private static final int RUNNING    = -1 << COUNT_BITS;
> private static final int SHUTDOWN   =  0 << COUNT_BITS;
> private static final int STOP       =  1 << COUNT_BITS;
> private static final int TIDYING    =  2 << COUNT_BITS;
> private static final int TERMINATED =  3 << COUNT_BITS;



<img src="https://gitee.com/breeze1002/upic/raw/master/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E5%A4%9A%E7%BA%BF%E7%A8%8B/2021%2010%2028%2011%2033%2006%201635391986%201635391986713%20XekICX%20image-20210622141404887.png" alt="image-20210622141404887" style="zoom:50%;" />



#### P2: æ„é€ æ–¹æ³•



```java
public ThreadPoolExecutor(int corePoolSize,
                          int maximumPoolSize,
                          long keepAliveTime,
                          TimeUnit unit,
                          BlockingQueue<Runnable> workQueue,
                          ThreadFactory threadFactory,
                          RejectedExecutionHandler handler)
```

- ##### **æ„é€ å‚æ•°è§£é‡Š**

> - corePoolSizeï¼šæ ¸å¿ƒçº¿ç¨‹æ•°
> - maximumPoolSizeï¼šæœ€å¤§çº¿ç¨‹æ•°
>   - maximumPoolSize - corePoolSize = æ•‘æ€¥çº¿ç¨‹æ•°
> - keepAliveTimeï¼šæ•‘æ€¥çº¿ç¨‹ç©ºé—²æ—¶çš„æœ€å¤§ç”Ÿå­˜æ—¶é—´
> - unitï¼šæ—¶é—´å•ä½
> - workQueueï¼šé˜»å¡é˜Ÿåˆ—ï¼ˆå­˜æ”¾ä»»åŠ¡ï¼‰
>   - æœ‰ç•Œé˜»å¡é˜Ÿåˆ— ArrayBlockingQueue
>   - æ— ç•Œé˜»å¡é˜Ÿåˆ— LinkedBlockingQueue
>   - æœ€å¤šåªæœ‰ä¸€ä¸ªåŒæ­¥å…ƒç´ çš„é˜Ÿåˆ— SynchronousQueue
> - ä¼˜å…ˆé˜Ÿåˆ— PriorityBlockingQueue
> - threadFactoryï¼šçº¿ç¨‹å·¥å‚ï¼ˆç»™çº¿ç¨‹å–åå­—ï¼‰
> - handlerï¼šæ‹’ç»ç­–ç•¥



#### P3: å·¥ä½œæµç¨‹

1. çº¿ç¨‹æ± ä¸­åˆšå¼€å§‹æ²¡æœ‰çº¿ç¨‹ï¼Œå½“ä¸€ä¸ªä»»åŠ¡æäº¤ç»™çº¿ç¨‹æ± åï¼Œçº¿ç¨‹æ± ä¼šåˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ã€‚
2. å½“çº¿ç¨‹æ•°è¾¾åˆ° corePoolSize å¹¶æ²¡æœ‰çº¿ç¨‹ç©ºé—²ï¼Œè¿™æ—¶å†åŠ å…¥ä»»åŠ¡ï¼Œæ–°åŠ çš„ä»»åŠ¡ä¼šè¢«åŠ å…¥ workQueue é˜Ÿåˆ—æ’ é˜Ÿï¼Œç›´åˆ°æœ‰ç©ºé—²çš„çº¿ç¨‹ã€‚
3. å¦‚æœé˜Ÿåˆ—é€‰æ‹©äº†æœ‰ç•Œé˜Ÿåˆ—ï¼Œé‚£ä¹ˆä»»åŠ¡è¶…è¿‡äº†é˜Ÿåˆ—å¤§å°æ—¶ï¼Œä¼šåˆ›å»º maximumPoolSize - corePoolSize æ•°ç›®çš„çº¿ ç¨‹æ¥æ•‘æ€¥ã€‚
4. å¦‚æœçº¿ç¨‹åˆ°è¾¾ maximumPoolSize ä»ç„¶æœ‰æ–°ä»»åŠ¡è¿™æ—¶ä¼šæ‰§è¡Œæ‹’ç»ç­–ç•¥ã€‚æ‹’ç»ç­–ç•¥ jdk æä¾›äº†ä¸‹é¢çš„å‰ 4 ç§å®ç°ï¼Œå…¶å®ƒè‘—åæ¡†æ¶ä¹Ÿæä¾›äº†å®ç°
   1. ThreadPoolExecutor.AbortPolicy è®©è°ƒç”¨è€…æŠ›å‡ºRejectedExecutionException å¼‚å¸¸ï¼Œè¿™æ˜¯é»˜è®¤ç­–ç•¥
   2. ThreadPoolExecutor.CallerRunsPolicy è®©è°ƒç”¨è€…è¿è¡Œä»»åŠ¡
   3. ThreadPoolExecutor.DiscardPolicy æ”¾å¼ƒæœ¬æ¬¡ä»»åŠ¡
   4. ThreadPoolExecutor.DiscardOldestPolicy æ”¾å¼ƒé˜Ÿåˆ—ä¸­æœ€æ—©çš„ä»»åŠ¡ï¼Œæœ¬ä»»åŠ¡å–è€Œä»£ä¹‹
   5. Dubbo çš„å®ç°ï¼Œåœ¨æŠ›å‡º RejectedExecutionException å¼‚å¸¸ä¹‹å‰ä¼šè®°å½•æ—¥å¿—ï¼Œå¹¶ dump çº¿ç¨‹æ ˆä¿¡æ¯ï¼Œæ–¹ ä¾¿å®šä½é—®é¢˜
   6. Netty çš„å®ç°ï¼Œæ˜¯åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡
   7. ActiveMQ çš„å®ç°ï¼Œå¸¦è¶…æ—¶ç­‰å¾…ï¼ˆ60sï¼‰å°è¯•æ”¾å…¥é˜Ÿåˆ—ï¼Œç±»ä¼¼æˆ‘ä»¬ä¹‹å‰è‡ªå®šä¹‰çš„æ‹’ç»ç­–ç•¥
   8. PinPoint çš„å®ç°ï¼Œå®ƒä½¿ç”¨äº†ä¸€ä¸ªæ‹’ç»ç­–ç•¥é“¾ï¼Œä¼šé€ä¸€å°è¯•ç­–ç•¥é“¾ä¸­æ¯ç§æ‹’ç»ç­–ç•¥
5. å½“é«˜å³°è¿‡å»åï¼Œè¶…è¿‡ corePoolSize çš„æ•‘æ€¥çº¿ç¨‹å¦‚æœä¸€æ®µæ—¶é—´æ²¡æœ‰ä»»åŠ¡åšï¼Œéœ€è¦ç»“æŸèŠ‚çœèµ„æºï¼Œè¿™ä¸ªæ—¶é—´ç”± keepAliveTime å’Œ unit æ¥æ§åˆ¶ã€‚



#### P4: ä¸‰ç§ç±»å‹çš„æ–¹æ³•

`Executoræ¡†æ¶çš„å·¥å…·ç±»Executorsæä¾›äº†ä¸‰ç§ç±»å‹çš„TreadPoolExecutor`

- **FixedThreadPool**

  `å›ºå®šå¤§å°çº¿ç¨‹æ± `

è¿™ä¸ªæ˜¯ Executors ç±»æä¾›çš„é™æ€çš„å·¥å‚æ–¹æ³•æ¥åˆ›å»ºçº¿ç¨‹æ± ï¼Executors æ˜¯ Executor æ¡†æ¶çš„å·¥å…·ç±»ï¼ŒnewFixedThreadPool åˆ›å»ºçš„æ˜¯**å›ºå®šå¤§å°çš„çº¿ç¨‹æ± **ã€‚å®ç°ä»£ç å¦‚ä¸‹ï¼š

```java
		// åˆ›å»ºå¤§å°ä¸º 2 çš„å›ºå®šçº¿ç¨‹æ± , è‡ªå®šä¹‰çº¿ç¨‹åç§°
        ExecutorService executorService = Executors.newFixedThreadPool(2, new ThreadFactory() {
            private AtomicInteger atomicInteger = new AtomicInteger(1);
            @Override
            public Thread newThread(Runnable r) {
                return new Thread(r, "my_thread_" + atomicInteger.getAndIncrement());
            }
        })
        // å¼€ 3 ä¸ªçº¿ç¨‹, çº¿ç¨‹æ± å¤§å°ä¸º 2 , ç¬¬ä¸‰ä¸ªçº¿ç¨‹æ‰§è¡Œæ—¶, å¦‚æœå‰ä¸¤ä¸ªçº¿ç¨‹ä»»åŠ¡æ²¡æ‰§è¡Œå®Œ, ä¼šåŠ å…¥ä»»åŠ¡é˜Ÿåˆ—.
        executorService.execute(() -> {
            log.info("1");
        });
        executorService.execute(() -> {
            log.info("2");
        });
        executorService.execute(() -> {
            log.info("3");
        });
```

 ğŸ´ **æ ¸å¿ƒ**

```java
public static ExecutorService newFixedThreadPool(int nThreads) {
        return new ThreadPoolExecutor(nThreads, nThreads,
                                      0L, TimeUnit.MILLISECONDS,
                                      new LinkedBlockingQueue<Runnable>());
    }
    public ThreadPoolExecutor(int corePoolSize,
                              int maximumPoolSize,
                              long keepAliveTime,
                              TimeUnit unit,
                              BlockingQueue<Runnable> workQueue) {
        this(corePoolSize, maximumPoolSize, keepAliveTime, unit, workQueue,
             Executors.defaultThreadFactory(), defaultHandler);
    }
```

é€šè¿‡æºç å¯ä»¥çœ‹åˆ° new ThreadPoolExecutor(xxx) æ–¹æ³•å…¶å®æ˜¯æ˜¯è°ƒç”¨äº†ä¹‹å‰è¯´çš„å®Œæ•´å‚æ•°çš„æ„é€ æ–¹æ³•ï¼Œåˆ›å»ºçš„æ˜¯å›ºå®šçš„çº¿ç¨‹æ•°ï¼Œä½¿ç”¨äº†é»˜è®¤çš„çº¿ç¨‹å·¥å‚å’Œæ‹’ç»ç­–ç•¥ã€‚

**ç‰¹ç‚¹**ï¼š

- æ ¸å¿ƒçº¿ç¨‹æ•° == æœ€å¤§çº¿ç¨‹æ•°ï¼ˆæ²¡æœ‰æ•‘æ€¥çº¿ç¨‹è¢«åˆ›å»ºï¼‰ï¼Œå› æ­¤ä¹Ÿæ— éœ€è¶…æ—¶æ—¶é—´
- é˜»å¡é˜Ÿåˆ—æ˜¯æ— ç•Œçš„ï¼ˆLinkedBlockingQueueï¼‰ï¼Œå¯ä»¥æ”¾ä»»æ„æ•°é‡çš„ä»»åŠ¡
- é€‚ç”¨äº**ä»»åŠ¡é‡å·²çŸ¥ï¼Œç›¸å¯¹è€—æ—¶çš„ä»»åŠ¡**



- **CachedThreadPool**

  `æ ¹æ®éœ€è¦åˆ›å»ºæ–°çº¿ç¨‹çš„çº¿ç¨‹æ± `

```java
  ExecutorService executorService = Executors.newCachedThreadPool();
	public static ExecutorService newCachedThreadPool() {
	 return new ThreadPoolExecutor(0, Integer.MAX_VALUE,
	 60L, TimeUnit.SECONDS,
	 new SynchronousQueue<Runnable>());
	}
```

**ç‰¹ç‚¹**:

- æ ¸å¿ƒçº¿ç¨‹æ•°æ˜¯ 0ï¼Œ æœ€å¤§çº¿ç¨‹æ•°æ˜¯ Integer.MAX_VALUEï¼Œæ•‘æ€¥çº¿ç¨‹çš„ç©ºé—²ç”Ÿå­˜æ—¶é—´æ˜¯ 60sï¼Œæ„å‘³ç€
  - **å…¨éƒ¨éƒ½æ˜¯æ•‘æ€¥çº¿ç¨‹**ï¼ˆ60s åæ²¡æœ‰ä»»åŠ¡å°±å›æ”¶ï¼‰
  - æ•‘æ€¥çº¿ç¨‹å¯ä»¥æ— é™åˆ›å»º
- é˜Ÿåˆ—é‡‡ç”¨äº† SynchronousQueue çš„å®ç°ç‰¹ç‚¹ï¼Œå®ƒæ²¡æœ‰å®¹é‡ï¼Œæ²¡æœ‰çº¿ç¨‹æ¥å–æ˜¯æ”¾ä¸è¿›å»çš„ï¼ˆä¸€æ‰‹äº¤é’±ã€ä¸€æ‰‹äº¤è´§ï¼‰
- æ•´ä¸ªçº¿ç¨‹æ± è¡¨ç°ä¸ºçº¿ç¨‹æ•°ä¼šæ ¹æ®ä»»åŠ¡é‡ä¸æ–­å¢é•¿ï¼Œæ²¡æœ‰ä¸Šé™ï¼Œå½“ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œç©ºé—² 1åˆ†é’Ÿåé‡Šæ”¾çº¿ç¨‹ã€‚
- é€‚åˆ**ä»»åŠ¡æ•°æ¯”è¾ƒå¯†é›†ï¼Œä½†æ¯ä¸ªä»»åŠ¡æ‰§è¡Œæ—¶é—´è¾ƒçŸ­çš„æƒ…å†µ**



- **SingleThreadExecutor**

  `åªæœ‰å•ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ± `

```java
public static ExecutorService newSingleThreadExecutor() {
 return new FinalizableDelegatedExecutorService
 (new ThreadPoolExecutor(1, 1,0L, TimeUnit.MILLISECONDS,new LinkedBlockingQueue<Runnable>()));
}
```

**ä½¿ç”¨åœºæ™¯:**

1. å¸Œæœ›å¤šä¸ªä»»åŠ¡æ’é˜Ÿæ‰§è¡Œã€‚çº¿ç¨‹æ•°å›ºå®šä¸º 1ï¼Œä»»åŠ¡æ•°å¤šäº 1 æ—¶ï¼Œä¼šæ”¾å…¥æ— ç•Œé˜Ÿåˆ—æ’é˜Ÿã€‚ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œè¿™å”¯ä¸€çš„çº¿ç¨‹ä¹Ÿä¸ä¼šè¢«é‡Šæ”¾ã€‚
2. newSingleThreadExecutor å’Œ newFixedThreadPool åŒºåˆ«ï¼š
   1. å’Œè‡ªå·±åˆ›å»ºå•çº¿ç¨‹æ‰§è¡Œä»»åŠ¡çš„åŒºåˆ«ï¼šè‡ªå·±åˆ›å»ºä¸€ä¸ªå•çº¿ç¨‹ä¸²è¡Œæ‰§è¡Œä»»åŠ¡ï¼Œå¦‚æœä»»åŠ¡æ‰§è¡Œå¤±è´¥è€Œç»ˆæ­¢é‚£ä¹ˆæ²¡æœ‰ä»»ä½•è¡¥æ•‘æªæ–½ï¼Œè€Œçº¿ç¨‹æ± è¿˜ä¼šæ–°å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œä¿è¯æ± çš„æ­£å¸¸å·¥ä½œ
   2. Executors.newSingleThreadExecutor() çº¿ç¨‹ä¸ªæ•°å§‹ç»ˆä¸º 1 ï¼Œä¸èƒ½ä¿®æ”¹
      FinalizableDelegatedExecutorService åº”ç”¨çš„æ˜¯è£…é¥°å™¨æ¨¡å¼ï¼Œåªå¯¹å¤–æš´éœ²äº† ExecutorService æ¥å£ï¼Œå› æ­¤ä¸èƒ½è°ƒç”¨ ThreadPoolExecutor ä¸­ç‰¹æœ‰çš„æ–¹æ³•
   3. å’ŒExecutors.newFixedThreadPool(1) åˆå§‹æ—¶ä¸º1æ—¶çš„åŒºåˆ«ï¼šExecutors.newFixedThreadPool(1) åˆå§‹æ—¶ä¸º1ï¼Œä»¥åè¿˜å¯ä»¥ä¿®æ”¹ï¼Œå¯¹å¤–æš´éœ²çš„æ˜¯ ThreadPoolExecutor å¯¹è±¡ï¼Œå¯ä»¥å¼ºè½¬åè°ƒç”¨ setCorePoolSize ç­‰æ–¹æ³•è¿›è¡Œä¿®æ”¹
      æ³¨æ„ï¼ŒExecutors è¿”å›çº¿ç¨‹æ± å¯¹è±¡çš„å¼Šç«¯å¦‚ä¸‹ï¼š

- FixedThreadPool å’Œ SingleThreadExecutor ï¼š å…è®¸è¯·æ±‚çš„é˜Ÿåˆ—é•¿åº¦ä¸º Integer.MAX_VALUE,å¯èƒ½å †ç§¯å¤§é‡çš„è¯·æ±‚ï¼Œä»è€Œå¯¼è‡´ OOMã€‚
- CachedThreadPool å’Œ ScheduledThreadPool ï¼š å…è®¸åˆ›å»ºçš„çº¿ç¨‹æ•°é‡ä¸º Integer.MAX_VALUE ï¼Œå¯èƒ½ä¼šåˆ›å»ºå¤§é‡çº¿ç¨‹ï¼Œä»è€Œå¯¼è‡´ OOMã€‚

è¯´ç™½äº†å°±æ˜¯ï¼šä½¿ç”¨æœ‰ç•Œé˜Ÿåˆ—ï¼Œæ§åˆ¶çº¿ç¨‹åˆ›å»ºæ•°é‡ã€‚
é™¤äº†é¿å… OOM çš„åŸå› ä¹‹å¤–ï¼Œä¸æ¨èä½¿ç”¨ Executorsæä¾›çš„ä¸¤ç§å¿«æ·çš„çº¿ç¨‹æ± çš„åŸå› è¿˜æœ‰:

- å®é™…ä½¿ç”¨ä¸­éœ€è¦æ ¹æ®è‡ªå·±æœºå™¨çš„æ€§èƒ½ã€ä¸šåŠ¡åœºæ™¯æ¥æ‰‹åŠ¨é…ç½®çº¿ç¨‹æ± çš„å‚æ•°æ¯”å¦‚æ ¸å¿ƒçº¿ç¨‹æ•°ã€ä½¿ç”¨çš„ä»»åŠ¡é˜Ÿåˆ—ã€é¥±å’Œç­–ç•¥ç­‰ç­‰ã€‚
- æˆ‘ä»¬åº”è¯¥æ˜¾ç¤ºåœ°ç»™æˆ‘ä»¬çš„çº¿ç¨‹æ± å‘½åï¼Œè¿™æ ·æœ‰åŠ©äºæˆ‘ä»¬å®šä½é—®é¢˜ã€‚



#### P5: æäº¤ä»»åŠ¡

```java
// æ‰§è¡Œä»»åŠ¡
void execute(Runnable command);

// æäº¤ä»»åŠ¡ taskï¼Œç”¨è¿”å›å€¼ Future è·å¾—ä»»åŠ¡æ‰§è¡Œç»“æœï¼ŒFutureçš„åŸç†å°±æ˜¯åˆ©ç”¨æˆ‘ä»¬ä¹‹å‰è®²åˆ°çš„ä¿æŠ¤æ€§æš‚åœæ¨¡å¼æ¥æ¥å—è¿”å›ç»“æœçš„ï¼Œä¸»çº¿ç¨‹å¯ä»¥æ‰§è¡Œ FutureTask.get()æ–¹æ³•æ¥ç­‰å¾…ä»»åŠ¡æ‰§è¡Œå®Œæˆ
<T> Future<T> submit(Callable<T> task);

// æäº¤ tasks ä¸­æ‰€æœ‰ä»»åŠ¡
<T> List<Future<T>> invokeAll(Collection<? extends Callable<T>> tasks)
 throws InterruptedException;

// æäº¤ tasks ä¸­æ‰€æœ‰ä»»åŠ¡ï¼Œå¸¦è¶…æ—¶æ—¶é—´
<T> List<Future<T>> invokeAll(Collection<? extends Callable<T>> tasks,
 long timeout, TimeUnit unit)
 throws InterruptedException;

// æäº¤ tasks ä¸­æ‰€æœ‰ä»»åŠ¡ï¼Œå“ªä¸ªä»»åŠ¡å…ˆæˆåŠŸæ‰§è¡Œå®Œæ¯•ï¼Œè¿”å›æ­¤ä»»åŠ¡æ‰§è¡Œç»“æœï¼Œå…¶å®ƒä»»åŠ¡å–æ¶ˆ
<T> T invokeAny(Collection<? extends Callable<T>> tasks)
 throws InterruptedException, ExecutionException;

// æäº¤ tasks ä¸­æ‰€æœ‰ä»»åŠ¡ï¼Œå“ªä¸ªä»»åŠ¡å…ˆæˆåŠŸæ‰§è¡Œå®Œæ¯•ï¼Œè¿”å›æ­¤ä»»åŠ¡æ‰§è¡Œç»“æœï¼Œå…¶å®ƒä»»åŠ¡å–æ¶ˆï¼Œå¸¦è¶…æ—¶æ—¶é—´
<T> T invokeAny(Collection<? extends Callable<T>> tasks,
 long timeout, TimeUnit unit)
 throws InterruptedException, ExecutionException, TimeoutException;
```



#### P6: å…³é—­çº¿ç¨‹æ± 

`shutdown`

```java
	/*
	  çº¿ç¨‹æ± çŠ¶æ€å˜ä¸º SHUTDOWN
	- ä¸ä¼šæ¥æ”¶æ–°ä»»åŠ¡
	- ä½†å·²æäº¤ä»»åŠ¡ä¼šæ‰§è¡Œå®Œï¼ŒåŒ…æ‹¬ç­‰å¾…é˜Ÿåˆ—é‡Œé¢çš„
	- æ­¤æ–¹æ³•ä¸ä¼šé˜»å¡è°ƒç”¨çº¿ç¨‹çš„æ‰§è¡Œ
	*/
    public void shutdown() {
        final ReentrantLock mainLock = this.mainLock;
        mainLock.lock();
        try {
            checkShutdownAccess();
            // ä¿®æ”¹çº¿ç¨‹æ± çŠ¶æ€
            advanceRunState(SHUTDOWN);
            // ä»…ä¼šæ‰“æ–­ç©ºé—²çº¿ç¨‹
            interruptIdleWorkers();
            onShutdown(); // æ‰©å±•ç‚¹ ScheduledThreadPoolExecutor
        } finally {
            mainLock.unlock();
        }
        // å°è¯•ç»ˆç»“(æ²¡æœ‰è¿è¡Œçš„çº¿ç¨‹å¯ä»¥ç«‹åˆ»ç»ˆç»“)
        tryTerminate();
    }
```

`shutdownNow`

```java
    /*
	çº¿ç¨‹æ± çŠ¶æ€å˜ä¸º STOP
	- ä¸ä¼šæ¥æ”¶æ–°ä»»åŠ¡
	- ä¼šå°†é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡è¿”å›
	- å¹¶ç”¨ interrupt çš„æ–¹å¼ä¸­æ–­æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡
	*/
    public List<Runnable> shutdownNow() {

        List<Runnable> tasks;
        final ReentrantLock mainLock = this.mainLock;
        mainLock.lock();
        try {
            checkShutdownAccess();
            // ä¿®æ”¹çº¿ç¨‹æ± çŠ¶æ€
            advanceRunState(STOP);
            // æ‰“æ–­æ‰€æœ‰çº¿ç¨‹
            interruptWorkers();
            // è·å–é˜Ÿåˆ—ä¸­å‰©ä½™ä»»åŠ¡
            tasks = drainQueue();
        } finally {
            mainLock.unlock();
        }
        // å°è¯•ç»ˆç»“
        tryTerminate();
        return tasks;
    }
```

`å…¶å®ƒ`

```java
// ä¸åœ¨ RUNNING çŠ¶æ€çš„çº¿ç¨‹æ± ï¼Œæ­¤æ–¹æ³•å°±è¿”å› true
boolean isShutdown();
// çº¿ç¨‹æ± çŠ¶æ€æ˜¯å¦æ˜¯ TERMINATED
boolean isTerminated();
// è°ƒç”¨ shutdown åï¼Œç”±äºè°ƒç”¨ä½¿çº¿ç¨‹ç»“æŸçº¿ç¨‹çš„æ–¹æ³•æ˜¯å¼‚æ­¥çš„å¹¶ä¸ä¼šç­‰å¾…æ‰€æœ‰ä»»åŠ¡è¿è¡Œç»“æŸå°±è¿”å›ï¼Œå› æ­¤å¦‚æœå®ƒæƒ³åœ¨çº¿ç¨‹æ±  TERMINATED ååšäº›å…¶å®ƒäº‹æƒ…ï¼Œå¯ä»¥åˆ©ç”¨æ­¤æ–¹æ³•ç­‰å¾…
boolean awaitTermination(long timeout, TimeUnit unit) throws InterruptedException;
```



#### P7 : ScheduledExecutor

`ScheduledThreadPoolExecutor` ä»»åŠ¡è°ƒåº¦çº¿ç¨‹æ± 

åœ¨ã€ä»»åŠ¡è°ƒåº¦çº¿ç¨‹æ± ã€åŠŸèƒ½åŠ å…¥ä¹‹å‰ï¼Œå¯ä»¥ä½¿ç”¨ java.util.Timer æ¥å®ç°å®šæ—¶åŠŸèƒ½ï¼ŒTimer çš„ä¼˜ç‚¹åœ¨äºç®€å•æ˜“ç”¨ï¼Œä½† ç”±äºæ‰€æœ‰ä»»åŠ¡éƒ½æ˜¯ç”±åŒä¸€ä¸ªçº¿ç¨‹æ¥è°ƒåº¦ï¼Œå› æ­¤æ‰€æœ‰ä»»åŠ¡éƒ½æ˜¯ä¸²è¡Œæ‰§è¡Œçš„ï¼ŒåŒä¸€æ—¶é—´åªèƒ½æœ‰ä¸€ä¸ªä»»åŠ¡åœ¨æ‰§è¡Œï¼Œå‰ä¸€ä¸ª ä»»åŠ¡çš„å»¶è¿Ÿæˆ–å¼‚å¸¸éƒ½å°†ä¼šå½±å“åˆ°ä¹‹åçš„ä»»åŠ¡ã€‚

ä½¿ç”¨ ScheduledExecutorService æ”¹å†™ï¼š

- æ•´ä¸ªçº¿ç¨‹æ± è¡¨ç°ä¸ºï¼šçº¿ç¨‹æ•°å›ºå®šï¼Œä»»åŠ¡æ•°å¤šäºçº¿ç¨‹æ•°æ—¶ï¼Œä¼šæ”¾å…¥æ— ç•Œé˜Ÿåˆ—æ’é˜Ÿã€‚ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œè¿™äº›çº¿ç¨‹ä¹Ÿä¸ä¼šè¢«é‡Šæ”¾ã€‚ç”¨æ¥æ‰§è¡Œå»¶è¿Ÿæˆ–åå¤æ‰§è¡Œçš„ä»»åŠ¡ã€‚
- ScheduledExecutorService ä¸­ scheduleAtFixedRate è®¾å®šperiodä¸º1s,è€Œä»»åŠ¡æ‰§è¡Œéœ€è¦2s,åˆ™é—´éš”2sæ‰§è¡Œ
- ScheduledExecutorService ä¸­ scheduleWithFixedDelay è®¾å®šdelayä¸º1s,è€Œä»»åŠ¡æ‰§è¡Œéœ€è¦2s,åˆ™é—´éš”3ç§’æ‰§è¡Œ



#### P8: å¤„ç†æ‰§è¡Œä»»åŠ¡å¼‚å¸¸

`çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ‰§è¡Œä»»åŠ¡æ—¶,å¦‚æœä»»åŠ¡æŠ›å‡ºäº†å¼‚å¸¸,é»˜è®¤æ˜¯ä¸­æ–­æ‰§è¡Œä»»åŠ¡è€Œä¸æ˜¯æŠ›å‡ºå¼‚å¸¸æˆ–è€…æ‰“å°å¼‚å¸¸ä¿¡æ¯`

- **æ–¹æ³•ä¸€: ä¸»åŠ¨æ•è·**

  ```java
  	ExecutorService pool = Executors.newFixedThreadPool(1);
  	pool.submit(() -> {
  		 try {
  			 log.debug("task1");
  			 int i = 1 / 0;
  		 } catch (Exception e) {
  		 	log.error("error:", e);
  		 }
  	});
  
  ```

  

- **æ–¹æ³•äºŒ: ä½¿ç”¨Future,å¼‚å¸¸ä¿¡æ¯ä¼šå°è£…è¿”å›**

  ```java
  	ExecutorService pool = Executors.newFixedThreadPool(1);
  	Future<Boolean> f = pool.submit(() -> {
  		 log.debug("task1");
  		 int i = 1 / 0;
  		 return true;
  	});
  	log.debug("result:{}", f.get());
  ```

  

#### P9: Tomcat çº¿ç¨‹æ± 

![image-20210623203849142](https://gitee.com/breeze1002/upic/raw/master/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E5%A4%9A%E7%BA%BF%E7%A8%8B/2021%2010%2028%2011%2033%2007%201635391987%201635391987604%20jEjEb4%20image-20210623203849142.png)

- LimitLatch ç”¨æ¥é™æµï¼Œå¯ä»¥æ§åˆ¶æœ€å¤§è¿æ¥ä¸ªæ•°ï¼Œç±»ä¼¼ J.U.C ä¸­çš„ Semaphore åé¢å†è®²
- Acceptor åªè´Ÿè´£ã€æ¥æ”¶æ–°çš„ socket è¿æ¥ã€‘
- Poller åªè´Ÿè´£ç›‘å¬ socket channel æ˜¯å¦æœ‰ã€å¯è¯»çš„ I/O äº‹ä»¶ã€‘
- ä¸€æ—¦å¯è¯»ï¼Œå°è£…ä¸€ä¸ªä»»åŠ¡å¯¹è±¡ï¼ˆsocketProcessorï¼‰ï¼Œæäº¤ç»™ Executor çº¿ç¨‹æ± å¤„ç†
- Executor çº¿ç¨‹æ± ä¸­çš„å·¥ä½œçº¿ç¨‹æœ€ç»ˆè´Ÿè´£ã€å¤„ç†è¯·æ±‚ã€‘

Tomcat çº¿ç¨‹æ± æ‰©å±•äº† ThreadPoolExecutorï¼Œè¡Œä¸ºç¨æœ‰ä¸åŒï¼Œå¦‚æœæ€»çº¿ç¨‹æ•°è¾¾maximumPoolSizeï¼Œè¿™æ—¶ä¸ä¼šç«‹åˆ»æŠ› RejectedExecutionException å¼‚å¸¸ï¼Œè€Œæ˜¯å†æ¬¡å°è¯•å°†ä»»åŠ¡æ”¾å…¥é˜Ÿåˆ—ï¼Œå¦‚æœè¿˜å¤±è´¥ï¼Œæ‰æŠ›å‡º RejectedExecutionException å¼‚å¸¸ã€‚

ğŸ´æºç  tomcat-7.0.42

```java
public void execute(Runnable command, long timeout, TimeUnit unit) {
  submittedCount.incrementAndGet();
  try {
    super.execute(command);
  } catch (RejectedExecutionException rx) {
    if (super.getQueue() instanceof TaskQueue) {
      final TaskQueue queue = (TaskQueue)super.getQueue();
      try {
        // ä½¿ä»»åŠ¡ä»æ–°è¿›å…¥é˜»å¡é˜Ÿåˆ—
        if (!queue.force(command, timeout, unit)) {
          submittedCount.decrementAndGet();
          throw new RejectedExecutionException("Queue capacity is full.");
        }
      } catch (InterruptedException x) {
        submittedCount.decrementAndGet();
        Thread.interrupted();
        throw new RejectedExecutionException(x);
      }
    } else {
      submittedCount.decrementAndGet();
      throw rx;
    }
  }
}

public boolean force(Runnable o, long timeout, TimeUnit unit) throws InterruptedException {
  if ( parent.isShutdown() )
    throw new RejectedExecutionException(
    "Executor not running, can't force a command into the queue"
  );
  return super.offer(o,timeout,unit); //forces the item onto the queue, to be used if the task
  is rejected
}
```



- **Connectoré…ç½®**

<img src="https://gitee.com/breeze1002/upic/raw/master/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E5%A4%9A%E7%BA%BF%E7%A8%8B/2021%2010%2028%2011%2033%2008%201635391988%201635391988685%20UOluv1%20image-20210623204235948.png" alt="image-20210623204235948" style="zoom:30%;float:left" />

- **Executoré…ç½®**

<img src="https://gitee.com/breeze1002/upic/raw/master/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E5%A4%9A%E7%BA%BF%E7%A8%8B/2021%2010%2028%2011%2033%2009%201635391989%201635391989856%20tXGy2V%20image-20210623204318750.png" alt="image-20210623204318750" style="zoom:30%;float:left" />

è¯¥çº¿ç¨‹æ± å®ç°æ˜¯ä½¿ç”¨äº†ä¸€ä¸ªæ— ç•Œé˜Ÿåˆ—,ä½†æ˜¯å½“æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹æ•°å¤§äºäº†æ ¸å¿ƒçº¿ç¨‹æ•°,ä½†å°äºæœ€å¤§çº¿ç¨‹æ—¶,å°±åˆ›å»ºæ•‘æ€¥çº¿ç¨‹,å¦åˆ™å°±åŠ å…¥é˜Ÿåˆ—



### D3: Fork/Join





## âœ¨J.U.C























